kubectl Cheat Sheet: https://kubernetes.io/docs/reference/kubectl/cheatsheet/#viewing-finding-resources

---
АБСТРАКЦИИ

Все абстракции в кубернетес существуют одна над другой.
ReplicaSet - абстракция, которая существует поверх абстракции Pod, а абстракция deployment существует поверх replicaSet.
ReplicaSet представляет из себя шаблон (template), который позволяет масштабировать поды.

Нужно взаимодействовать с теми объектами, которые создавала. То есть несмотря на то, что деплоймент создает репликасеты,
взаимодействовать нужно с деплоймент (при необходимости изменить репликасет, созданный через деплоймент, меняем через 
деплоймент). 

Если в apiVersion указано v1 или v2, то это базовый объект, а
если указано apps/v1 - то объект, который основывается на базовом другом объекте, напр. объект replicaSet, основанный на pod.

Deployment.
Deployment - это абстракция, которая существует над replicaSet. Фактически деплоймент нужен для обновления версий наших приложений.
Деплоймент будет создавать репликасеты с новыми версиями наших приложений, а эти репликасеты создадут новые поды и удалят старые.

При изменении деплоймента будет создан новый репликасет, а старый репликасет не удалится. Это необходимо для 
обновления по RollingUpdate - постепенное обновление объекта за объектом. При RollingUpdate новая версия должна быть обратно
совместимой, поскольку запросы от пользователя в момент обновления могут отправляться в разные поды с разными версиями.
Старый репликасет сохранится, но количество его под будет равно нулю.

Resources.
Limits:
    - количество ресурсов, которые под может использовать
    - верхняя граница
Requests:
    - количество ресурсов, которые резервируются для пода на ноде
    - не делятся с другими подами на ноде
Requests позволяет куберу определять сколько свободных ресурсов осталось в кластере. Кубер не умеет следить за реальным потреблением ресурсов, он смотрит
только на реквесты (даже если сервис не использует ресурс, указанный в реквесте, кубер не отдаст эти ресурсы другому сервису).


---

ХРАНЕНИЕ КОНФИГУРАЦИЙ

Переменные окружения можно прописать в деплойменте spec.template.spec.containers.env (или поде). Переменные окружения обычно используются если эта переменная нужна только
в одном сервисе. Если одна и та же переменная нужна в нескольких сервисах, то лучше использовать configmap, чтобы не дублировать эту переменную в разных деплойментах.

ConfigMap - абстракция для создания переменных и конфигураций, конфигмап можно подключать к нескольким деплойментам.
Конфигмап можно прописать в деплойменте spec.template.spec.containers.envFrom.configMapRef (или поде). Можно подключить несколько конфигмап
к одному деплойменту.

Secret
Типы секретов:
 generic - пароли/токены
 docker-registry - данные авторизации в docker registry
 tls - TLS сертификаты для Ingress
Секрет не шифрует информацию, а только кодирует (base64).

Downward API

Служебные поля, полученные из команды
    kubectl get po <pod_name> -o yaml
можно использовать в downward

---
ФЛАГ -o

Получить значение только одного поля, в данном случае поля image:
kubectl get po <pod_name> -o=jsonpath='{.spec.containers[*].image}{"\n"}'

Позволяет вывести описание объекта с пользовательским набором полей:
kubectl get deployment my-deployment -o custom-columns='NAME:.metadata.name,MAXSURGE:.spec.strategy.rollingUpdate.maxSurge,MAXUNAVAILABLE:.spec.strategy.rollingUpdate.maxUnavailable'
Пример вывода:
NAME            MAXSURGE            MAXUNAVAILABLE
my-deployment   1                   0



Ключ -o jsonpath позволяет получить не весь объект целиком, а только содержимое конкретных полей.
Он крайне полезен при написании скриптов для автоматизации задач в Kubernetes.
Почитать про его возможности подробней можно тут:
    https://kubernetes.io/docs/reference/kubectl/jsonpath/

---